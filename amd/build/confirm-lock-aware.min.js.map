{"version":3,"file":"confirm-lock-aware.min.js","sources":["../src/confirm-lock-aware.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Ask student to confirm that they are aware that editing will be locked.\n *\n * @copyright  2020 Xi'an Jiaotong-Liverpool University\n * @author     Frédéric Massart <fred@branchup.tech>\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\ndefine(['jquery', 'core/str', 'core/notification'], function($, Str, Notification) {\n\n    const strings = [\n        {key: 'areyousure', component: 'core'},\n        {key: 'confirmlockeditingaware', component: 'mod_peerwork'},\n        {key: 'yes', component: 'core'},\n        {key: 'no', component: 'core'},\n    ];\n\n    /**\n     * Init function.\n     *\n     * @param {String} selector The form selector.\n     */\n    function init(selector) {\n\n        // Preload strings.\n        const stringsPromise = Str.get_strings(strings).catch(Notification.exception);\n\n        // Listen to form submissions.\n        $(selector).on('submit', (e) => {\n            if (this._confirmed) {\n                return;\n            }\n\n            e.preventDefault();\n            const form = $(e.target);\n\n            stringsPromise.then(([title, question, yesLabel, noLabel]) => {\n                return Notification.confirm(title, question, yesLabel, noLabel, () => {\n                    this._confirmed = true;\n                    form.submit();\n                });\n            }).catch(Notification.exception);\n\n        });\n    }\n\n    return {\n        init: init\n    };\n\n});\n"],"names":["define","$","Str","Notification","strings","key","component","init","selector","stringsPromise","get_strings","catch","exception","on","e","this","_confirmed","preventDefault","form","target","then","_ref","title","question","yesLabel","noLabel","confirm","submit"],"mappings":";;;;;;;AAuBAA,yCAAO,CAAC,SAAU,WAAY,sBAAsB,SAASC,EAAGC,IAAKC,oBAE3DC,QAAU,CACZ,CAACC,IAAK,aAAcC,UAAW,QAC/B,CAACD,IAAK,0BAA2BC,UAAW,gBAC5C,CAACD,IAAK,MAAOC,UAAW,QACxB,CAACD,IAAK,KAAMC,UAAW,eAgCpB,CACHC,cAzBUC,gBAGJC,eAAiBP,IAAIQ,YAAYN,SAASO,MAAMR,aAAaS,WAGnEX,EAAEO,UAAUK,GAAG,UAAWC,OAClBC,KAAKC,kBAITF,EAAEG,uBACIC,KAAOjB,EAAEa,EAAEK,QAEjBV,eAAeW,MAAKC,WAAEC,MAAOC,SAAUC,SAAUC,qBACtCtB,aAAauB,QAAQJ,MAAOC,SAAUC,SAAUC,SAAS,UACvDT,YAAa,EAClBE,KAAKS,eAEVhB,MAAMR,aAAaS"}