/**
 * Support for unlocking editing of a student or submission.
 *
 * @copyright  2020 Xi'an Jiaotong-Liverpool University
 * @author     Frédéric Massart <fred@branchup.tech>
 * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 */
define("mod_peerwork/unlock-editing",["jquery","core/ajax","core/str","core/notification"],(function($,Ajax,Str,Notification){const strings=[{key:"areyousure",component:"core"},{key:"yes",component:"core"},{key:"no",component:"core"},{key:"confirmunlockeditingsubmission",component:"mod_peerwork"},{key:"confirmunlockeditinggrader",component:"mod_peerwork"}];return{init:function(submissionSelector,graderSelector){const stringsPromise=Str.get_strings(strings).catch(Notification.exception);$(submissionSelector).on("click",(e=>{e.preventDefault();const node=$(e.currentTarget),submissionId=node.data("submissionid");stringsPromise.then((_ref=>{let[title,yesLabel,noLabel,qSubmission]=_ref;return Notification.confirm(title,qSubmission,yesLabel,noLabel,(()=>{node.hide(),Ajax.call([{methodname:"mod_peerwork_unlock_submission",args:{submissionid:submissionId}}])[0].then((()=>(node.remove(),!0))).catch((e=>(node.show(),Notification.exception(e))))}))})).catch(Notification.exception)})),$(graderSelector).on("click",(e=>{e.preventDefault();const node=$(e.currentTarget),peerworkId=node.data("peerworkid"),graderId=node.data("graderid"),graderName=node.data("graderfullname");stringsPromise.then((_ref2=>{let[title,yesLabel,noLabel]=_ref2;return Notification.confirm(title,M.util.get_string("confirmunlockeditinggrader","mod_peerwork",graderName),yesLabel,noLabel,(()=>{const nodes=$(graderSelector).filter("[data-graderid=".concat(graderId,"]"));nodes.hide(),Ajax.call([{methodname:"mod_peerwork_unlock_grader",args:{peerworkid:peerworkId,graderid:graderId}}])[0].then((()=>(nodes.remove(),!0))).catch((e=>(nodes.show(),Notification.exception(e))))}))})).catch(Notification.exception)}))}}}));

//# sourceMappingURL=unlock-editing.min.js.map